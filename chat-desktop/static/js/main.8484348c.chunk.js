(this["webpackJsonpfinalchat2.0"]=this["webpackJsonpfinalchat2.0"]||[]).push([[0],{38:function(e,a,t){e.exports=t(55)},43:function(e,a,t){},55:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),s=t(12),l=t.n(s),r=t(3),i={profileOpened:!1,searchValueMessages:"",searchValueContacts:""};var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"profile/open":return Object(r.a)(Object(r.a)({},e),{},{profileOpened:!e.profileOpened});case"profile/close":return Object(r.a)(Object(r.a)({},e),{},{profileOpened:!1});case"application/setSearchValueMessages":return Object(r.a)(Object(r.a)({},e),{},{searchValueMessages:a.payload});case"application/setSearchValueContacts":return Object(r.a)(Object(r.a)({},e),{},{searchValueContacts:a.payload});default:return e}},m={loading:!0,items:[],itemId:{}};var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"contacts/load/start":return Object(r.a)(Object(r.a)({},e),{},{loading:!0});case"contacts/load/success":return Object(r.a)(Object(r.a)({},e),{},{loading:!1,items:a.payload});case"contacts/chat/selected":return Object(r.a)(Object(r.a)({},e),{},{itemId:a.payload});default:return e}},d=t(35),v={loading:!0,chatLog:[],sentMessage:"",sentMessageType:"text"};var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"messages/load/start":return Object(r.a)(Object(r.a)({},e),{},{loading:!0});case"messages/load/success":return Object(r.a)(Object(r.a)({},e),{},{loading:!1,chatLog:a.payload});case"message/send/value":return Object(r.a)(Object(r.a)({},e),{},{sentMessage:a.payload});case"message/send/type":return Object(r.a)(Object(r.a)({},e),{},{sentMessageType:a.payload});case"message/send/start":return Object(r.a)(Object(r.a)({},e),{},{loading:!1});case"message/send/success":return Object(r.a)(Object(r.a)({},e),{},{chatLog:[].concat(Object(d.a)(e.chatLog),[a.payload]),sentMessage:""});default:return e}},p={id:{},loading:!0};var E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"profile/load/id/start":return Object(r.a)(Object(r.a)({},e),{},{loading:!0});case"profile/load/id/success":return Object(r.a)(Object(r.a)({},e),{},{id:a.payload,loading:!1});default:return e}},h=(t(43),t(5)),b=t(1),g=t(20);var N=function(){var e=document.getElementById("bottom");e.scrollTop=e.scrollHeight};var O=function(e){var a=e.message;return c.a.createElement("div",{key:a._id,className:"message-info"},c.a.createElement("span",null,a.content))},j=t(13),y=t.n(j);var k=function(e){var a=e.message;return c.a.createElement("div",{key:a._id,className:"message-to"},c.a.createElement("span",{className:"message-to-content"},c.a.createElement("div",null,a.content),c.a.createElement("div",{className:"message-time"},a.hasOwnProperty("time")&&y()(a.time).format("h:mm"),a.read?c.a.createElement("div",{className:"material-icons"},"done_all"):c.a.createElement("div",{className:"material-icons"},"done"))))};var x=function(e){var a=e.message,t=Object(h.f)().id,n=Object(b.c)((function(e){return e.contacts.items.find((function(e){return e._id===t}))}));return c.a.createElement("div",{key:a._id,className:"message-from"},c.a.createElement("div",{className:"pic-avatar-min-2"},n.fullname[0]),c.a.createElement("span",{className:"message-from-content"},c.a.createElement("div",null,a.content),c.a.createElement("div",{className:"message-time"},a.hasOwnProperty("time")&&y()(a.time).format("h:mm"))))};var w=function(e){var a=e.message,t=Object(b.c)((function(e){return e.profile.id}));return t._id===a.toUserId&&"text"===a.type?c.a.createElement(x,{message:a}):"info"===a.type?c.a.createElement(O,{message:a}):t._id!==a.toUserId&&"text"===a.type?c.a.createElement(k,{message:a}):null};var M=function(){var e=Object(b.b)(),a=Object(b.c)((function(e){return e.messages.chatLog})),t=Object(b.c)((function(e){return e.application.searchValueMessages})),s=Object(h.f)().id,l=Object(b.c)((function(e){return e.profile.id})),r=a.filter((function(e){var a=e.content.toLowerCase(),n=t.toLowerCase();return-1!==a.indexOf(n)}));return Object(n.useEffect)((function(){e(function(e,a){return function(t){t({type:"messages/load/start"}),fetch("https://api.intocode.ru:8001/api/messages/".concat(a,"/").concat(e)).then((function(e){return e.json()})).then((function(e){t({type:"messages/load/success",payload:e}),N()}))}}(s,l._id))}),[e,s,l]),Object(g.a)("shift+p",(function(){e((function(e){e({type:"profile/open"})}))}),{filter:function(){return!0}}),c.a.createElement("div",{className:"main-box-chat-log"},c.a.createElement("div",{className:"messages",id:"bottom"},r.map((function(e){return c.a.createElement(w,{key:e._id,message:e})}))))},_=t(56),C=t(57);var V=function(){var e=Object(b.c)((function(e){return e.profile.id})),a=Object(h.f)().id,t=Object(b.c)((function(e){return e.messages.sentMessage})),n=Object(b.c)((function(e){return e.messages.sentMessageType})),s=Object(b.b)(),l=function(t){""!==t&&s(function(e,a,t,n){return function(c){c({type:"message/send/start"}),fetch("https://api.intocode.ru:8001/api/messages",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({myId:"".concat(e),contactId:"".concat(a),type:"".concat(n),content:"".concat(t)})}).then((function(e){return e.json()})).then((function(e){c({type:"message/send/success",payload:e}),N()}))}}(e._id,a,t,n))};return Object(g.a)("enter",(function(e){e.preventDefault(),l(t)}),[t]),c.a.createElement("div",{className:"mic"},c.a.createElement(_.a,null,c.a.createElement(C.a,{key:t.length<1,addEndListener:function(e,a){return e.addEventListener("transitionend",a,!1)},classNames:"fade"},t.length<1?c.a.createElement("span",{className:"material-icons",style:{color:"#565656",marginRight:"20px"}},"mic"):c.a.createElement("span",{className:"material-icons",onClick:function(){l(t)},style:{color:"#565656",marginRight:"20px"}},"send"))))};var L=function(){return c.a.createElement("div",{className:"staple"},c.a.createElement("span",{className:"material-icons",style:{color:"#565656",marginRight:"20px"}},"attach_file"))};var S=function(){var e=Object(b.c)((function(e){return e.messages.sentMessage})),a=Object(b.b)();return c.a.createElement("div",{className:"main-box-bottom"},c.a.createElement("div",{className:"input-message"},c.a.createElement("input",{placeholder:"Write a message",type:"text",value:e,onChange:function(e){var t;a((t=e.target.value,function(e){e({type:"message/send/value",payload:t})}))}})),c.a.createElement("div",{className:"staple-mic"},c.a.createElement(L,null),c.a.createElement(V,null)))};var T=function(){var e=Object(b.c)((function(e){return e.application.searchValueMessages})),a=Object(b.b)();return c.a.createElement("div",{className:"search-icon-box"},c.a.createElement("span",{className:"material-icons"},"search"),c.a.createElement("div",{className:"input-search"},c.a.createElement("input",{type:"search",placeholder:"chat search",className:"search-bar-skeleton",value:e,onChange:function(e){var t;a((t=e.target.value,function(e){e({type:"application/setSearchValueMessages",payload:t})}))}})))};var I=function(){var e=Object(b.c)((function(e){return e.messages.loading})),a=Object(b.b)();return c.a.createElement("div",{className:"option-icon-box"},c.a.createElement("span",{className:"material-icons",style:e?{pointerEvents:"none",opacity:"0.4"}:{},onClick:function(){return a((function(e){e({type:"profile/open"})}))}},"settings"))};var P=function(){var e=Object(h.f)().id,a=Object(b.c)((function(e){return e.contacts.items})),t=Object(b.c)((function(e){return e.messages.loading})),n=a.find((function(a){return a._id===e}));return c.a.createElement("div",{className:"main-box-header"},c.a.createElement(T,null),c.a.createElement("div",{className:"name-in-box"},t?c.a.createElement("div",null,"loading"):c.a.createElement("div",{className:"status-div"},n.fullname,n.hasOwnProperty("online")&&(n.online?c.a.createElement("div",{className:"online"}):c.a.createElement("div",{className:"offline"})))),c.a.createElement(I,null))};var J=function(){var e=Object(h.f)().id;return Object(b.c)((function(e){return e.contacts.items})).find((function(a){return a._id===e}))?c.a.createElement("div",{className:"main-box"},c.a.createElement(P,null),c.a.createElement(M,null),c.a.createElement(S,null)):c.a.createElement("div",{className:"box-loading",id:"bottom"},"Please, select a chat to start messaging")};var R=function(e){var a=e.item;return c.a.createElement("div",null,c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"pic-avatar-full"},c.a.createElement("div",null,a.fullname[0])),c.a.createElement("div",{className:"min-header"},c.a.createElement("div",{className:"name-profile"},a.fullname),c.a.createElement("div",{className:"tag"},"@",a.username),c.a.createElement("div",{className:"icons-for-profile"},c.a.createElement("div",{className:"call"},c.a.createElement("span",{className:"material-icons md-32"},"call")),c.a.createElement("div",{className:"video"},c.a.createElement("span",{className:"material-icons"},"videocam")),c.a.createElement("div",{className:"mail"},c.a.createElement("span",{className:"material-icons"},"mail"))))))},B=t(21),H=t(22);var U=function(e){var a=e.item;return a.hasOwnProperty("socials")&&c.a.createElement("div",{className:"body"},c.a.createElement("div",null,"Social"),c.a.createElement("div",{className:"min-body"},(null===a||void 0===a?void 0:a.socials)&&a.socials.instagram&&c.a.createElement("div",{className:"iconT"},c.a.createElement("div",{className:"icon"},c.a.createElement(B.a,{className:"facebook",icon:H.b})),c.a.createElement("div",null,(null===a||void 0===a?void 0:a.socials)&&a.socials.instagram)),(null===a||void 0===a?void 0:a.socials)&&a.socials.twitter&&c.a.createElement("div",{className:"iconT"},c.a.createElement("div",{className:"icon"},c.a.createElement(B.a,{className:"facebook",icon:H.c})),c.a.createElement("div",null,(null===a||void 0===a?void 0:a.socials)&&a.socials.twitter)),(null===a||void 0===a?void 0:a.socials)&&a.socials.facebook&&c.a.createElement("div",{className:"iconT"},c.a.createElement("div",{className:"icon"},c.a.createElement(B.a,{className:"facebook",icon:H.a})),c.a.createElement("div",null,(null===a||void 0===a?void 0:a.socials)&&a.socials.facebook))))};var z=function(){return c.a.createElement("div",{className:"bottom"},c.a.createElement("div",null,"Media"),c.a.createElement("div",{className:"files-media"},c.a.createElement("div",{className:"object-media"}),c.a.createElement("div",{className:"text-object"},"desktop-chat.pdf")))};var A=function(){var e=Object(h.f)().id,a=Object(b.c)((function(e){return e.contacts.items})),t=Object(b.c)((function(e){return e.messages.loading})),n=a.find((function(a){return a._id===e}));return c.a.createElement("div",{className:"profile-tab"},t?c.a.createElement("div",null):c.a.createElement("div",null,c.a.createElement(R,{item:n}),c.a.createElement(U,{item:n}),c.a.createElement(z,null)))};var D=function(){var e=Object(b.c)((function(e){return e.application.profileOpened}));return c.a.createElement(C.a,{in:e,timeout:1e3,unmountOnExit:!0,classNames:"profile"},c.a.createElement(A,null))};var W=function(e){var a=e.contact;return c.a.createElement("div",{className:"pic-avatar-min"},c.a.createElement("div",null,c.a.createElement("div",{className:"pic-avatar-min-letter"},a.fullname[0],a.online?c.a.createElement("span",{className:"pic-avatar-min-status"}):c.a.createElement("span",null))))};var q=function(e){var a,t,n=e.contact;return c.a.createElement("div",{className:"name-and-message-min"},c.a.createElement("div",{className:"name-contact-min"},n.fullname),c.a.createElement("div",{className:"last-message-min"},(null===(t=null===(a=n.lastMessage)||void 0===a?void 0:a.content)||void 0===t?void 0:t.length)>10?t.substring(0,9)+"...":t))};var F=function(e){var a,t=e.contact;return c.a.createElement("div",{className:"last-time-min"},y()(null===(a=t.lastMessage)||void 0===a?void 0:a.time).format("hh:mm"))};var G=function(e){var a=e.contact,t=Object(h.f)().id,n=Object(b.b)(),s=Object(h.e)();return c.a.createElement("div",{className:t===a._id?"chat-contact-selected":"chat-contact",onClick:function(){return function(e){var a;t!==e._id&&(n((a=e,function(e){e({type:"profile/close"}),e({type:"contacts/chat/selected",payload:a})})),s.push(e._id))}(a)}},c.a.createElement(W,{contact:a}),c.a.createElement(q,{contact:a}),c.a.createElement(F,{contact:a}))};var K=function(){var e=Object(b.c)((function(e){return e.contacts.items})),a=Object(b.c)((function(e){return e.application.searchValueContacts})),t=e.filter((function(e){var t=e.fullname.toLowerCase(),n=a.toLowerCase();return-1!==t.indexOf(n)}));return c.a.createElement("div",{className:"chat-contact-container"},t.map((function(e){return c.a.createElement(G,{key:e._id,contact:e})})))};var Q=function(){var e=Object(b.c)((function(e){return e.application.searchValueContacts})),a=Object(b.b)();return c.a.createElement("div",{className:"for-search"},c.a.createElement("div",{className:"search-contact-1"},c.a.createElement("div",{className:"search-contact-2"},c.a.createElement("i",{className:"material-icons"},"search")),c.a.createElement("div",{className:"input-search"},c.a.createElement("input",{type:"search",placeholder:"search contact",className:"search-bar-skeleton",value:e,onChange:function(e){var t;a((t=e.target.value,function(e){e({type:"application/setSearchValueContacts",payload:t})}))}}))))};var X=function(){return c.a.createElement("div",{className:"out-chat-box"},c.a.createElement("div",{className:"chat-box"},c.a.createElement(Q,null),c.a.createElement(K,null)))};var Y=function(){return c.a.createElement("div",{className:"app"},c.a.createElement(h.a,{path:"/:id?"},c.a.createElement(X,null),c.a.createElement(J,null),c.a.createElement(D,null)))},Z=t(18),$=t.n(Z);var ee=function(){return c.a.createElement("div",{className:"skeleton-outer-box"},[1,2,3,4,5,6,7,8,9].map((function(e){return c.a.createElement("div",{className:"chat-skeleton",key:e,style:{fontSize:16,lineHeight:1.2}},c.a.createElement("div",{className:"circle-skeleton"},c.a.createElement(Z.SkeletonTheme,{color:"#e3e3e3"},c.a.createElement($.a,{circle:!0,height:40,width:40}))),c.a.createElement("div",{className:"line-skeleton"},c.a.createElement(Z.SkeletonTheme,{color:"#e3e3e3"},c.a.createElement($.a,{count:2,width:j.max}))))})))};var ae=function(){return c.a.createElement("div",{className:"skeleton"},c.a.createElement("div",{className:"chat-box-skeleton"},c.a.createElement("div",{className:"search-skeleton"},c.a.createElement("div",{className:"search-skeleton-2"},c.a.createElement("i",{className:"material-icons"},"search")),c.a.createElement("div",{className:"input-skeleton"},c.a.createElement("input",{type:"search",placeholder:"search contact",className:"search-bar-skeleton"}))),c.a.createElement(ee,null)),c.a.createElement("div",{className:"box-loading"},"Please, select a chat to start messaging"))};var te=function(){var e=Object(b.b)(),a=Object(b.c)((function(e){return e.contacts.loading})),t=Object(b.c)((function(e){return e.profile.loading}));return Object(n.useEffect)((function(){e((function(e){e({type:"contacts/load/start"}),fetch("https://api.intocode.ru:8001/api/contacts").then((function(e){return e.json()})).then((function(a){e({type:"contacts/load/success",payload:a})}))})),e((function(e){e({type:"profile/load/id/start"}),fetch("https://api.intocode.ru:8001/api/profile").then((function(e){return e.json()})).then((function(a){e({type:"profile/load/id/success",payload:a})}))}))}),[e]),a||t?c.a.createElement(ae,null):c.a.createElement(Y,null)},ne=t(15),ce=t(33),se=t(34),le=t.n(se),re=(t(54),t(11)),ie=Object(ne.c)({application:o,contacts:u,messages:f,profile:E}),oe=Object(ne.d)(ie,Object(ne.a)(ce.a,le.a));l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(b.a,{store:oe},c.a.createElement(re.a,null,c.a.createElement(te,null)))),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.8484348c.chunk.js.map